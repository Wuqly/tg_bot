
&НаСервере
Процедура ЗагрузитьДанныеНаСервере(Результат, ДопПараметр) Экспорт
	// Вставить содержимое обработчика.
	Если Не (Результат = Неопределено) Тогда
		СсылкаНаФайл = Результат[0];
	Иначе
		Сообщить("Файл не выбран!");
	КонецЕсли;
	
	ТабДок = Новый ТабличныйДокумент;
	ТабДок.Прочитать(СсылкаНаФайл);
	
	Для Строка = 2 По 6 Цикл
		ЭлементыСпрСотрудники = Справочники.Сотрудники.СоздатьЭлемент(); 
		ЭлементыСпрСотрудники.Наименование = ТабДок.Область(Строка,4).Текст;
			НаименованиеДолжности = ТабДок.Область(Строка,2).Текст; //Код который отображает должность при редактировании 
	    	Должность = Справочники.Должности.НайтиПоНаименованию(НаименованиеДолжности); //
	    	ЭлементыСпрСотрудники.Должность = Должность.Ссылка; //
		ЭлементыСпрСотрудники.Оклад = ТабДок.Область(Строка,3).Текст;
		ЭлементыСпрСотрудники.ПаспортныеДанные = ТабДок.Область(Строка,5).Текст;  
		ДатаСтрокой = ТабДок.Область(Строка,6).Текст;
		День = Лев(ДатаСтрокой,2);
		Месяц = Сред(ДатаСтрокой,4,2);
		Год = Прав(ДатаСтрокой,4);
		ЭлементыСпрСотрудники.ДатаРождения = Дата(Год,Месяц,День);
		ЭлементыСпрСотрудники.ДомашнийАдрес = ТабДок.Область(Строка,7).Текст;
			НаименованиеПола = ТабДок.Область(Строка,8).Текст; //Код который отображает Пол при редактировании
			Пол = Неопределено;
			Пол = Перечисления.Пол[НаименованиеПола];
			ЭлементыСпрСотрудники.Пол = Пол;
		ЭлементыСпрСотрудники.Телефон = ТабДок.Область(Строка,9).Текст;
		ЭлементыСпрСотрудники.ИНН = ТабДок.Область(Строка,10).Текст; 
		ЭлементыСпрСотрудники.Записать();
		Элементы.Список.Обновить();  // Автомотическое обновление после импортирования
		Сообщить("В справочник Сотрудники добавлена запись " + ЭлементыСпрСотрудники.Наименование);
	КонецЦикла;
КонецПроцедуры

&НаКлиенте
Процедура ЗагрузитьДанные(Команда)
	ВыборФайла = Новый ДиалогВыбораФайла(РежимДиалогаВыбораФайла.Открытие);
	ВыборФайла.МножественныйВыбор = Ложь;
	ВыборФайла.Фильтр = "Табличный документ *.xlsx |*.xlsx";
	ВыборФайла.Показать(Новый ОписаниеОповещения("ЗагрузитьДанныеНаСервере",ЭтотОбъект,Новый Структура));
КонецПроцедуры
